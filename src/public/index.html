<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Midnight Guardian</title>
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <!-- Custom Title Bar -->
    <div class="title-bar">
        <div class="app-title">Midnight Guardian</div>
        <div class="window-controls">
            <button class="control-btn close" onclick="window.electronAPI.minimizeToTray()">√ó</button>
        </div>
    </div>

    <!-- Scrollable Content -->
    <div class="content-area">
        <div class="dashboard-grid">

            <!-- Stats Row (Mimicking G-Helper's Temp/Fan row) -->
            <div
                style="display: flex; justify-content: space-between; padding: 0 4px; margin-bottom: 8px; font-size: 11px; color: var(--text-secondary);">
                <span>üõ°Ô∏è <span id="stat-blocks" style="color: var(--text-primary);">0</span> Blocks</span>
                <span>‚è±Ô∏è <span id="stat-saved" style="color: var(--text-primary);">0h 0m</span> Focus</span>
                <span>üî• <span id="stat-streak" style="color: var(--text-primary);">1</span> Day Streak</span>
            </div>

            <!-- Section: Active Monitoring -->
            <div>
                <div class="section-header">
                    <span class="section-icon">‚ö°</span> Focus Mode
                    <span id="activeTimeDisplay" class="schedule-display" style="margin-left: auto;">09:00 -
                        17:00</span>
                    <button class="add-btn-small" onclick="openTimeModal('active')"
                        style="border:none; color: #555;">‚úèÔ∏è</button>
                </div>
                <div class="button-grid" style="grid-template-columns: 1fr 1fr 1fr;"> <!-- Back to 3 cols -->
                    <div id="btn-active-off" class="mode-btn" onclick="setActiveMode(false)">
                        <span class="mode-icon">‚è∏Ô∏è</span>
                        <span>Off</span>
                    </div>
                    <div id="btn-active-on" class="mode-btn" onclick="setActiveMode(true)">
                        <span class="mode-icon">‚ö°</span>
                        <span>Active</span>
                    </div>
                    <div class="mode-btn" onclick="toggleStrict()">
                        <span class="mode-icon" id="strict-icon">üîì</span>
                        <span id="strict-text">Strict</span>
                    </div>
                </div>
                <!-- Description Text -->
                <div id="active-desc" class="mode-desc">Select a mode to see details</div>
            </div>

            <!-- Section: Midnight Check -->
            <div>
                <div class="section-header">
                    <span class="section-icon">üåô</span> Sleep Guardian
                    <span id="midnightTimeDisplay" class="schedule-display" style="margin-left: auto;">23:00 -
                        07:00</span>
                    <button class="add-btn-small" onclick="openTimeModal('midnight')"
                        style="border:none; color: #555;">‚úèÔ∏è</button>
                </div>

                <div class="button-grid">
                    <div id="btn-midnight-off" class="mode-btn" onclick="setMidnightMode(false, false)">
                        <span class="mode-icon">üõå</span>
                        <span>Off</span>
                    </div>
                    <div id="btn-midnight-on" class="mode-btn" onclick="setMidnightMode(true, false)">
                        <span class="mode-icon">üõ°Ô∏è</span>
                        <span>Guard</span>
                    </div>
                    <div id="btn-midnight-shutdown" class="mode-btn" onclick="setMidnightMode(true, true)">
                        <span class="mode-icon">üîå</span>
                        <span>Shutdown</span>
                    </div>
                </div>
                <!-- Description Text -->
                <div id="midnight-desc" class="mode-desc">Select a mode to see details</div>
            </div>

            <!-- Section: Rules & Whitelist -->
            <div>
                <div class="section-header">
                    <span class="section-icon">üìú</span> Rules
                </div>

                <div class="chips-grid" style="margin-bottom: 8px;">
                    <div style="width:100%; display:flex; justify-content:space-between; margin-bottom:4px;">
                        <span style="font-size:10px; color:#ff6b6b;">BLOCKED</span>
                        <button class="add-btn-small" onclick="openKeywordModal('block')">+</button>
                    </div>
                    <div id="blockChips" style="display:flex; flex-wrap:wrap; gap:4px; width:100%;"></div>
                </div>

                <div class="chips-grid">
                    <div style="width:100%; display:flex; justify-content:space-between; margin-bottom:4px;">
                        <span style="font-size:10px; color:#1dd1a1;">ALLOWED</span>
                        <button class="add-btn-small" onclick="openKeywordModal('allow')">+</button>
                    </div>
                    <div id="allowChips" style="display:flex; flex-wrap:wrap; gap:4px; width:100%;"></div>
                </div>
            </div>

            <!-- Section: System -->
            <div>
                <div class="section-header">
                    <span class="section-icon">‚öôÔ∏è</span> System
                </div>
                <div
                    style="background: var(--card-bg); border-radius: 6px; padding: 10px; border: 1px solid var(--border); display:flex; justify-content:space-between;">
                    <span style="font-size:11px; color:var(--text-secondary);">Run on Startup</span>
                    <input type="checkbox" id="runOnStartup" onclick="saveConfig()">
                </div>
            </div>

            <!-- Spacer -->
            <div style="flex:1;"></div>

            <!-- Bottom Bar -->
            <div class="bottom-bar">
                <div class="bottom-actions">
                    <div class="version-text">v1.0.0</div>
                </div>

                <div class="bottom-actions">
                    <button class="pill-btn" onclick="showLogs()">
                        <span>üìú Logs</span>
                    </button>
                    <button class="pill-btn" onclick="saveConfig()">
                        <span>üíæ Save</span>
                    </button>
                    <button class="pill-btn" onclick="window.electronAPI.hideOverlay()">
                        <span>‚ùå Close</span>
                    </button>
                </div>
            </div>
        </div> <!-- End content-area -->

        <!-- Modals (Re-using logic, just styling active in CSS) -->

        <!-- Time Modal -->
        <div id="timeModal" class="modal-overlay">
            <div class="modal">
                <h3>Edit Schedule</h3>
                <div style="display: flex; gap: 8px; justify-content: center; margin-bottom: 20px;">
                    <select id="modalStartHour" class="time-select"></select> :
                    <select id="modalStartMinute" class="time-select"></select>
                    <span style="align-self:center; color:#555;">‚ûú</span>
                    <select id="modalEndHour" class="time-select"></select> :
                    <select id="modalEndMinute" class="time-select"></select>
                </div>
                <div class="btn-group">
                    <button class="pill-btn" onclick="closeModal('timeModal')">Cancel</button>
                    <button class="pill-btn primary" onclick="saveTimeModal()">Apply</button>
                </div>
            </div>
        </div>

        <!-- Keyword Modal -->
        <div id="keywordModal" class="modal-overlay">
            <div class="modal">
                <h3>Add Keyword</h3>
                <input type="text" id="modalKeywordInput" placeholder="Enter keyword..."
                    style="width: 100%; padding: 8px; background: #111; border: 1px solid #444; color: white; border-radius: 4px; margin-bottom: 20px;">
                <div class="btn-group">
                    <button class="pill-btn" onclick="closeModal('keywordModal')">Cancel</button>
                    <button class="pill-btn primary" onclick="saveKeywordModal()">Add</button>
                </div>
            </div>
        </div>

        <!-- Logs Modal -->
        <div id="logsModal" class="modal-overlay">
            <div class="modal" style="width: 400px;">
                <div style="display: flex; justify-content: space-between; align-items:center; margin-bottom: 8px;">
                    <h3>Activity Logs</h3>
                    <button class="add-btn-small" onclick="clearLogs()">Clear</button>
                </div>
                <div id="logsList"
                    style="height: 250px; overflow-y: auto; background: #111; border: 1px solid #333; padding: 8px; font-family: monospace; font-size: 10px; color: #ccc;">
                </div>
                <div class="btn-group">
                    <button class="pill-btn" onclick="closeModal('logsModal')">Close</button>
                </div>
            </div>
        </div>

        <script src="script.js"></script>
</body>

</html>