<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Midnight Guardian</title>
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <!-- Custom Title Bar -->
    <div class="title-bar">
        <div class="app-title">Midnight Guardian</div>
        <div class="window-controls">
            <button class="control-btn close" onclick="window.electronAPI.minimizeToTray()">√ó</button>
        </div>
    </div>

    <!-- Scrollable Content -->
    <div class="content-area">
        <div class="dashboard-grid">



            <!-- Section: Active Monitoring -->
            <div>
                <div class="section-header">
                    <span class="section-icon">‚ö°</span> Focus Mode
                    <span id="activeTimeDisplay" class="schedule-display" style="margin-left: auto;">09:00 -
                        17:00</span>
                    <button class="add-btn-small" onclick="openTimeModal('active')"
                        style="border:none; color: #555;">‚úé</button>
                </div>
                <div class="button-grid" style="grid-template-columns: 1fr 1fr 1fr;"> <!-- Back to 3 cols -->
                    <div id="btn-off" class="mode-btn" onclick="setActiveMode(false)">
                        <span class="mode-icon">‚è∏Ô∏è</span>
                        <span>Off</span>
                    </div>
                    <div id="btn-active" class="mode-btn" onclick="setActiveMode(true)">
                        <span class="mode-icon">‚ö°</span>
                        <span>Active</span>
                    </div>
                    <div id="btn-strict" class="mode-btn" onclick="toggleStrict()">
                        <span class="mode-icon" id="strict-icon">üîì</span>
                        <span id="strict-text">Strict</span>
                    </div>
                </div>
                <!-- Description Text -->
                <div id="active-desc" class="mode-desc">Select a mode to see details</div>

            </div>

            <!-- Shutdown Cards (Vertical Stack) -->
            <div>
                <!-- Shutdown At End -->
                <div class="dashboard-card"
                    style="margin-bottom: 10px; display: flex; justify-content: space-between; align-items: center;">
                    <span style="font-size:11px; color:var(--text-secondary);">Shutdown PC at End Time</span>
                    <input type="checkbox" id="shutdownAtEnd" onclick="saveConfig()">
                </div>

                <!-- Scheduled Shutdown -->
                <div class="dashboard-card" style="display: flex; justify-content: space-between; align-items: center;">
                    <div style="display:flex; align-items:center; gap:6px;">
                        <span style="font-size:11px; color:var(--text-secondary);">Scheduled Shutdown</span>
                        <div class="info-icon" data-tooltip="Force shutdown regardless of activity">i</div>
                    </div>
                    <div style="display:flex; align-items:center; gap:8px;">
                        <span id="shutdownTimeDisplay" class="schedule-display">--:--</span>
                        <button class="icon-btn edit-btn" onclick="openTimeModal('shutdown')"
                            aria-label="Edit time">‚úé</button>
                        <input type="checkbox" id="shutdownEnabled" onclick="saveConfig()">
                    </div>
                </div>
            </div>



            <!-- Section: Rules & Whitelist -->
            <div>
                <div class="section-header">
                    <span class="section-icon">üìú</span> Rules
                </div>

                <div class="chips-grid" style="margin-bottom: 8px;">
                    <div style="width:100%; display:flex; justify-content:space-between; margin-bottom:4px;">
                        <span style="font-size:10px; color:#ff6b6b;">BLOCKED</span>
                        <button class="add-btn-small" onclick="openKeywordModal('block')">+</button>
                    </div>
                    <div id="blockChips" style="display:flex; flex-wrap:wrap; gap:4px; width:100%;"></div>
                </div>

                <div class="chips-grid">
                    <div style="width:100%; display:flex; justify-content:space-between; margin-bottom:4px;">
                        <span style="font-size:10px; color:#1dd1a1;">ALLOWED</span>
                        <button class="add-btn-small" onclick="openKeywordModal('allow')">+</button>
                    </div>
                    <div id="allowChips" style="display:flex; flex-wrap:wrap; gap:4px; width:100%;"></div>
                </div>
            </div>

            <!-- Section: System -->
            <div>
                <div class="section-header">
                    <span class="section-icon">‚öôÔ∏è</span> System
                </div>
                <div
                    style="background: var(--card-bg); border-radius: 6px; padding: 10px; border: 1px solid var(--border); display:flex; justify-content:space-between;">
                    <span style="font-size:11px; color:var(--text-secondary);">Run on Startup</span>
                    <input type="checkbox" id="runOnStartup" onclick="saveConfig()">
                </div>
            </div>

            <!-- Bottom Bar -->
            <div class="bottom-bar">
                <div class="bottom-actions">
                    <div class="version-text">v1.0.0</div>
                </div>

                <div class="bottom-actions">
                    <button class="pill-btn" onclick="showLogs()">
                        <span>üìú Logs</span>
                    </button>
                    <button class="pill-btn" onclick="saveConfig()">
                        <span>üíæ Save</span>
                    </button>
                    <button class="pill-btn" onclick="window.electronAPI.quitApp()">
                        <span>‚ùå Close</span>
                    </button>
                </div>
            </div>

            <!-- Modals (Re-using logic, just styling active in CSS) -->

            <!-- Time Modal -->
            <div id="timeModal" class="modal-overlay">
                <div class="modal">
                    <h3>Edit Schedule</h3>
                    <div style="display: flex; flex-direction: column; gap: 12px; margin-bottom: 20px;">
                        <!-- Start Time Group -->
                        <div id="modalStartGroup"
                            style="display: flex; gap: 8px; justify-content: center; align-items: center;">
                            <label style="min-width: 80px; font-size: 11px; color: var(--text-secondary);">Start
                                Time</label>
                            <select id="modalStartHour" class="time-select"></select>
                            <span>:</span>
                            <select id="modalStartMinute" class="time-select"></select>
                        </div>
                        <!-- End Time Group -->
                        <div id="modalEndGroup"
                            style="display: flex; gap: 8px; justify-content: center; align-items: center;">
                            <label id="modalEndLabel"
                                style="min-width: 80px; font-size: 11px; color: var(--text-secondary);">End Time</label>
                            <select id="modalEndHour" class="time-select"></select>
                            <span>:</span>
                            <select id="modalEndMinute" class="time-select"></select>
                        </div>
                    </div>
                    <div class="btn-group">
                        <button id="timeModalCancel" class="pill-btn">Cancel</button>
                        <button id="timeModalApply" class="pill-btn primary">Apply</button>
                    </div>
                </div>
            </div>

            <!-- Keyword Modal -->
            <div id="keywordModal" class="modal-overlay">
                <div class="modal">
                    <h3>Add Keyword</h3>
                    <input type="text" id="modalKeywordInput" placeholder="Enter keyword..."
                        style="width: 100%; padding: 8px; background: #111; border: 1px solid #444; color: white; border-radius: 4px; margin-bottom: 20px;">
                    <div class="btn-group">
                        <button class="pill-btn" onclick="closeModal('keywordModal')">Cancel</button>
                        <button class="pill-btn primary" onclick="saveKeywordModal()">Add</button>
                    </div>
                </div>
            </div>

            <!-- Logs Modal -->
            <div id="logsModal" class="modal-overlay">
                <div class="modal" style="width: 400px;">
                    <div style="display: flex; justify-content: space-between; align-items:center; margin-bottom: 8px;">
                        <h3>Activity Logs</h3>
                        <button class="add-btn-small" onclick="clearLogs()">Clear</button>
                    </div>
                    <div id="logsList"
                        style="height: 250px; overflow-y: auto; background: #111; border: 1px solid #333; padding: 8px; font-family: monospace; font-size: 10px; color: #ccc;">
                    </div>
                    <div class="btn-group">
                        <button class="pill-btn" onclick="closeModal('logsModal')">Close</button>
                    </div>
                </div>
            </div>

            <script src="script.js"></script>
</body>

</html>